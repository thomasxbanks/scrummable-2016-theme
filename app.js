'use strict';var screen_width=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth;var screen_height=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;var body=document.body,html=document.documentElement;var document_height=function document_height(){return Math.max(body.scrollHeight,body.offsetHeight,html.clientHeight,html.scrollHeight,html.offsetHeight);};var browser={width:window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,height:window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight};var elementSize={colophon:{height:document.querySelector('#colophon').clientHeight},masthead:{height:document.querySelector('#masthead').clientHeight}};function debouncer(func,timeout){var timeoutID,timeout=timeout||200;return function(){var scope=this,args=arguments;clearTimeout(timeoutID);timeoutID=setTimeout(function(){func.apply(scope,Array.prototype.slice.call(args));},timeout);};}var numberizePixels=function numberizePixels(element){var elementHeight=window.getComputedStyle(element).getPropertyValue('height');return~~elementHeight.substr(0,elementHeight.length-2);};var return_to_top=function return_to_top(){window.scrollTo(0,numberizePixels(document.querySelector('.hero-full')));};var max_height=function max_height(){var maxHeightElements=document.querySelectorAll('.max-height');for(var i=0;i<maxHeightElements.length;i++){maxHeightElements[i].style.height=browser.height;}};var detectIE=function detectIE(){var ua=window.navigator.userAgent;var msie=ua.indexOf('MSIE ');if(msie>0){return parseInt(ua.substring(msie+5,ua.indexOf('.',msie)),10);}var trident=ua.indexOf('Trident/');if(trident>0){var rv=ua.indexOf('rv:');return parseInt(ua.substring(rv+3,ua.indexOf('.',rv)),10);}var edge=ua.indexOf('Edge/');if(edge>0){return parseInt(ua.substring(edge+5,ua.indexOf('.',edge)),10);}return false;};function vaporise(scroll){if(document.querySelector('.vaporise')){if(scroll<browser.height){var _vaporise=document.querySelector('.vaporise .hero__title');var parallax=document.querySelector('.vaporise .hero-full');var opacity=1-scroll/1000>0?1-scroll/1000:0;var scale=1+scroll/1000>1?1+scroll/1000:1;var blur=1+scroll/10>1?1+scroll/100:0;parallax.style.transform='translate3d(0, '+(0+scroll/2)+'px, 0)';_vaporise.style.opacity=opacity;_vaporise.style.transform='scale('+scale+')';_vaporise.style.filter='blur('+blur+'px)';}}}function sidebar(variant){var otherSidebars=document.querySelectorAll('.sidebar:not([id="sidebar--'+variant+'"])');for(var i=0;i<otherSidebars.length;i++){otherSidebars[i].setAttribute('data-state','closed');}document.querySelector('#sidebar--'+variant).setAttribute('data-state','open');}function bsod(){if(document.querySelector('.error404')){document.querySelector('#bsod').style.transition='opacity ease-in 500ms';setTimeout(function(){document.querySelector('#bsod').style.opacity=0;setTimeout(function(){document.querySelector('#bsod').outerHTML='';},1000);},2000);}}function global_functions(){document_height();max_height();if(window.pageYOffset>0){document.querySelector('#masthead').classList.add('fade-in');document.querySelector('#masthead').classList.add('open');}}window.onload=function(){global_functions();var heroImages=document.querySelectorAll('.hero-full');var _loop=function _loop(){var src=heroImages[i].getAttribute('data-src');var thumb=heroImages[i].previousElementSibling;if(detectIE()){heroImages[i].parentElement.style.backgroundImage='url("'+src+'")';thumb.classList.add('hide');}else{heroImages[i].setAttribute('src',src);heroImages[i].onload=function(){thumb.classList.add('hide');};}};for(var i=0;i<heroImages.length;i++){_loop();}};if(detectIE()){document.querySelector('html').classList.add('is-ie');}else{document.querySelector('html').classList.add('not-ie');}var CurrentScroll=0;window.onscroll=function(){var scroll=window.pageYOffset;if(scroll>screen_height/2){document.querySelector('#masthead').classList.add('open');}else{document.querySelector('#masthead').classList.remove('open');}if(scroll>screen_height){document.querySelector('.scroll-up').setAttribute('data-state','shown');document.querySelector('.scroll-down').setAttribute('data-state','hidden');}else{document.querySelector('.scroll-up').setAttribute('data-state','hidden');document.querySelector('.scroll-down').setAttribute('data-state','shown');}if(scroll>document_height-screen_height*2){document.querySelector('button#return_to_top').setAttribute('data-state','is-shown');}else{document.querySelector('button#return_to_top').setAttribute('data-state','not-shown');}var sidebars=document.querySelectorAll('.sidebar');for(var i=0;i<sidebars.length;i++){if(sidebars[i].getAttribute('data-state')==='open'){sidebar('all');}}vaporise(scroll);if(scroll>CurrentScroll){document.querySelector('#masthead').classList.add('slide-away');}else{document.querySelector('#masthead').classList.remove('slide-away');}CurrentScroll=scroll;};var navButtons=document.querySelectorAll('.nav-icon button');for(var i=0;i<navButtons.length;i++){navButtons[i].addEventListener('click',function(e){var variant=e.currentTarget.getAttribute('data-sidebar');var currentState=document.querySelector('#sidebar--'+variant).getAttribute('data-state');if(currentState==='open'){sidebar('all');}else{sidebar(variant);}});}bsod();window.onresize=function(e){global_functions();};
